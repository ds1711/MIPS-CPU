

# MIPS-CPU

A MIPS 5 level pipeline CPU written by VerilogHDL

其中有使用流水线和不使用流水线两种代码，未使用流水线的MIPS CPU代码设计了38条指令，其中有20条整数指令，12条扩展整数指令和六条中断原子指令。
使用流水线的MIPS CPU代码设计了32条指令，有20条整数指令和12条扩展整数指令。



​                                                              ***\*MIPS基本指令集 20条整数指令\****

R型指令：

| 指令 | [31:26] | [25:21] | [20:16] | [15:11] | [10:6] | [5:0]  | 意义       |
| ---- | ------- | ------- | ------- | ------- | ------ | ------ | ---------- |
| add  | 000000  | rs      | rt      | rd      | 00000  | 100000 | 寄存器加   |
| sub  | 000000  | rs      | rt      | rd      | 00000  | 100010 | 寄存器减   |
| and  | 000000  | rs      | rt      | rd      | 00000  | 100100 | 寄存器与   |
| or   | 000000  | rs      | rt      | rd      | 00000  | 100101 | 寄存器或   |
| xor  | 000000  | rs      | rt      | rd      | 00000  | 100110 | 寄存器异或 |
| sll  | 000000  | 00000   | rt      | rd      | sa     | 000000 | 左移       |
| srl  | 000000  | 00000   | rt      | rd      | sa     | 000010 | 逻辑右移   |
| sra  | 000000  | 00000   | rt      | rd      | sa     | 000011 | 算术右移   |
| jr   | 000000  | rs      | 00000   | 00000   | 00000  | 001000 | 寄存器跳转 |

I型指令：

| 指令 | [31:26] | [25:21] | [20:16] | [15:0]    | 意义         |
| ---- | ------- | ------- | ------- | --------- | ------------ |
| addi | 001000  | rs      | rt      | immediate | 立即数加     |
| andi | 001100  | rs      | rt      | immediate | 立即数与     |
| ori  | 001101  | rs      | rt      | immediate | 立即数或     |
| xori | 001110  | rs      | rt      | immediate | 立即数异或   |
| lw   | 100011  | rs      | rt      | offset    | 取整数数据字 |
| sw   | 101011  | rs      | rt      | offset    | 存整数数据字 |
| beq  | 000100  | rs      | rt      | offset    | 相等转移     |
| bne  | 000101  | rs      | rt      | offset    | 不等转移     |
| lui  | 001111  | 00000   | rt      | immediate | 设置高位     |

J型指令：

| 指令 | [31:26] | [25:0]  | 意义 |
| ---- | ------- | ------- | ---- |
| j    | 000010  | address | 跳转 |
| jal  | 000011  | address | 调用 |

 

​                                                                  ***\*MIPS扩展指令集 12条整数指令\****

| 指令         | [31:26] | [25:21] | [20:16] | [15:11] | [10:6] | [5:0]  | 功能               |
| ------------ | ------- | ------- | ------- | ------- | ------ | ------ | ------------------ |
| slt rd,rs,rt | 000000  | rs      | rt      | Rd      | 00000  | 101010 | rd<-(rs<rt),signed |

| 指令           | [31:26] | [25:21] | [20:16] | [15:0] | 功能                |
| -------------- | ------- | ------- | :------ | ------ | ------------------- |
| bgtz rs,offset | 000111  | rs      | 00000   | offset | if rs>0,then branch |
| bltz rs,offset | 000001  | rs      | 00000   | offset | if rs<0,then branch |

| 指令        | [31:26] | [25:21] | [20:16] | [15:11] | [10:6] | [5:0]  | 功能                    |
| ----------- | ------- | ------- | ------- | ------- | ------ | ------ | ----------------------- |
| Jalr rd,rs  | 000000  | rs      | 00000   | Rd      | 00000  | 001001 | rd<-npc,PC<-rs          |
| mult rs,rt  | 000000  | rs      | rt      | 00000   | 00000  | 011000 | {hi,lo}<-rs*rt,signed   |
| multu rs,rt | 000000  | rs      | rt      | 00000   | 00000  | 011001 | {hi,lo}<-rs*rt,unsigned |
| div rs,rt   | 000000  | rs      | rt      | 00000   | 00000  | 011010 | {hi,lo}<-rs/rt,signed   |
| divu rs,rt  | 000000  | rs      | rt      | 00000   | 00000  | 011011 | {hi,lo}<-rs/rt,unsigned |
| mfhi rd     | 000000  | 00000   | 00000   | Rd      | 00000  | 010000 | rd<-hi                  |
| mflo rd     | 000000  | 00000   | 00000   | Rd      | 00000  | 010010 | rd<-lo                  |
| mthi rs     | 000000  | rs      | 00000   | 00000   | 00000  | 010001 | hi<-rs                  |
| mtlo rs     | 000000  | rs      | 00000   | 00000   | 00000  | 010011 | lo<-rs                  |

​                                                                  ***\*MIPS中断原子指令集 6条中断原子指令\****

| 指令             | [31:26] | [25:21] | [20:16] | [15:0] | 功能                         |
| ---------------- | ------- | ------- | ------- | ------ | ---------------------------- |
| ll rt,offset     | 110000  | rs      | rt      | offset | load;LLbit=1                 |
| sc rt,offset(rs) | 111000  | rs      | rt      | offset | if(LLbit)store ;rt=1elsert=0 |

| 指令       | [31:26] | [25:21] | [20:16] | [15:11] | [10:6] | [5:0]  | 功能             |
| ---------- | ------- | ------- | ------- | ------- | ------ | ------ | ---------------- |
| mfc0 rt,rd | 010000  | 00000   | rt      | rd      | 00000  | 000000 | rt<-cp0[rd]      |
| mtc0 rt,rd | 010000  | 00100   | rt      | rd      | 00000  | 000000 | cp0[rd]<-rt      |
| eret       | 010000  | 10000   | 00000   | 00000   | 00000  | 011000 | PC<-epc,LLbit<-0 |

| 指令    | [31:26] | [25:6] | [5:0]  | 功能            |
| ------- | ------- | ------ | ------ | --------------- |
| syscall | 00000   | 0      | 001100 | SysInt,LLbit<-0 |
